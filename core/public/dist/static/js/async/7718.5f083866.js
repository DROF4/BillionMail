"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["7718"],{93953:function(e,t,l){l.d(t,{Z:()=>g});var a=l(65083),n=l(58786),r=l(56946),o=l(54470),u=l(51048),i=l(71309),s=l(60951),d=l(6445),c=l(73238);let p={name:"Flex",self:function(){return c.Z}},m=Object.assign(Object.assign({},r.Z.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,reverse:Boolean,size:{type:[String,Number,Array],default:"medium"},wrap:{type:Boolean,default:!0}}),g=(0,n.aZ)({name:"Flex",props:m,setup(e){let{mergedClsPrefixRef:t,mergedRtlRef:l}=(0,o.ZP)(e),s=(0,r.Z)("Flex","-flex",void 0,p,e,t);return{rtlEnabled:(0,u.V)("Flex",l,t),mergedClsPrefix:t,margin:(0,n.Fl)(()=>{let{size:t}=e;if(Array.isArray(t))return{horizontal:t[0],vertical:t[1]};if("number"==typeof t)return{horizontal:t,vertical:t};let{self:{[(0,i.Tl)("gap",t)]:l}}=s.value,{row:n,col:r}=(0,a.yU)(l);return{horizontal:(0,a.fQ)(r),vertical:(0,a.fQ)(n)}})}},render(){let{vertical:e,reverse:t,align:l,inline:a,justify:r,margin:o,wrap:u,mergedClsPrefix:i,rtlEnabled:c}=this,p=(0,s.x)((0,d.z)(this),!1);return p.length?(0,n.h)("div",{role:"none",class:[`${i}-flex`,c&&`${i}-flex--rtl`],style:{display:a?"inline-flex":"flex",flexDirection:e&&!t?"column":e&&t?"column-reverse":!e&&t?"row-reverse":"row",justifyContent:r,flexWrap:!u||e?"nowrap":"wrap",alignItems:l,gap:`${o.vertical}px ${o.horizontal}px`}},p):null}})},51169:function(e,t,l){l.d(t,{d:()=>o});var a=l(58786),n=l(49247);let r=Symbol("MODAL_INJECT"),o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{state:t={},component:l,onCancel:o,onConfirm:u}=e,i=(0,a.qj)({});return l?[(0,a.aZ)({setup(n,o){let{attrs:u,slots:s}=o;return(0,a.JJ)(r,{state:t,options:e,extendApi:e=>{Object.setPrototypeOf(i,e)},setState:e=>{Object.assign(t,e)}}),()=>(0,a.h)(l,{...n,...u},s)}}),i]:[(0,a.aZ)({setup(t,l){let{attrs:s,slots:d}=l,c=(0,a.f3)(r),p=(0,a.iH)(!1);return i.open=()=>{var t;p.value=!0,null==(t=e.onChangeState)||t.call(e,p.value)},i.close=()=>{p.value=!1},i.setState=t=>{var l;null==c||c.setState(t),null==(l=e.onChangeState)||l.call(e,p.value)},i.getState=()=>(null==c?void 0:c.state)??{},null==c||c.extendApi(i),()=>(0,a.Wm)(n.Z,(0,a.dG)({show:p.value},t,s,{onCancel:o,onConfirm:u,"onUpdate:show":e=>{p.value=e??!1}}),d)}}),i]}},46244:function(e,t,l){l.d(t,{Z:()=>r});var a=l(98048),n=l(58786);let r=(0,n.aZ)({__name:"index",props:{model:{},rules:{},labelWidth:{},labelPlacement:{default:"top"}},setup(e,t){let{expose:l}=t,r=(0,n.iH)(null);return l({validate:()=>{var e;return null==(e=r.value)?void 0:e.validate()},restoreValidation:()=>{var e;return null==(e=r.value)?void 0:e.restoreValidation()}}),(e,t)=>{let l=a.Z;return(0,n.wg)(),(0,n.j4)(l,(0,n.dG)(e.$attrs,{ref_key:"formRef",ref:r,model:e.model,rules:e.rules,"label-width":e.labelWidth,"label-placement":e.labelPlacement}),{default:(0,n.w5)(()=>[(0,n.WI)(e.$slots,"default")]),_:3},16,["model","rules","label-width","label-placement"])}}})},54181:function(e,t,l){l.r(t),l.d(t,{default:()=>P});var a=l(39244),n=l(25170),r=l(60424),o=l(66760),u=l(86559),i=l(58786),s=l(15496),d=l(93953),c=l(94821),p=l(68271),m=l(51169),g=l(80947),f=l(43458),v=l(69311),_=l(12112),S=l(46244),h=l(8490),U=l(73084),w=l(6455);let b={class:"flex-1 mr-12px"},y=(0,i.aZ)({__name:"TagSelect",props:(0,i.Vf)({groupId:{type:Number,default:0}},{value:{default:()=>[]},valueModifiers:{}}),emits:["update:value"],setup(e){let t=(0,i.tT)(e,"value"),l=(0,i.iH)(!1),a=(0,i.iH)([]),n=(0,i.Fl)(()=>a.value.filter(t=>t.group_id===e.groupId).map(e=>({label:e.name,value:e.id}))),r=async()=>{try{l.value=!0;let e=await (0,f.CZ)({});(0,p.Kn)(e)&&(a.value=e.list)}finally{l.value=!1}};r(),(0,i.YP)(()=>e.groupId,e=>{t.value=a.value.filter(t=>t.group_id===e).map(e=>e.id)});let[o,u]=(0,m.d)({component:_.Z,state:{refresh:r}}),d=()=>{u.setState({row:null,isEdit:!1,groupId:e.groupId}),u.open()};return(e,a)=>{let r=h.Z,u=s.ZP;return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",b,[(0,i.Wm)(r,{value:t.value,"onUpdate:value":a[0]||(a[0]=e=>t.value=e),loading:(0,i.SU)(l),tag:!0,multiple:!0,filterable:!0,options:(0,i.SU)(n)},null,8,["value","loading","options"])]),(0,i.Wm)(u,{type:"primary",text:"",onClick:d},{default:(0,i.w5)(()=>[(0,i.Uk)((0,i.zw)(e.$t("common.actions.create")),1)]),_:1}),(0,i.Wm)((0,i.SU)(o))],64)}}});var k=l(52495);let Z=(0,i.aZ)({__name:"TagBulk",setup(e){let{t}=(0,k.QT)(),l=(0,i.qj)({group_id:null,tag_ids:[],data:"",mark_include:1}),a=(0,i.Fl)(()=>[{label:t("contacts.tags.bulk.actions.tagThese"),value:1},{label:t("contacts.tags.bulk.actions.tagExcept"),value:0}]),n=()=>{l.group_id=null,l.tag_ids=[],l.data="",l.mark_include=1},[r]=(0,m.d)({onChangeState:()=>{n()},onConfirm:async()=>{await (0,f.Rc)({group_id:l.group_id||0,tag_ids:l.tag_ids,data:l.data,mark_include:l.mark_include})}});return(e,n)=>{let o=w.ZP,u=U.Z,s=h.Z,d=S.Z;return(0,i.wg)(),(0,i.j4)((0,i.SU)(r),{title:(0,i.SU)(t)("contacts.tags.bulk.title"),width:"560"},{default:(0,i.w5)(()=>[(0,i.Wm)(d,{ref:"formRef",class:"pt-16px",model:(0,i.SU)(l)},{default:(0,i.w5)(()=>[(0,i.Wm)(o,{label:(0,i.SU)(t)("contacts.tags.bulk.form.group"),path:"group_id"},{default:(0,i.w5)(()=>[(0,i.Wm)(v.Z,{value:(0,i.SU)(l).group_id,"onUpdate:value":n[0]||(n[0]=e=>(0,i.SU)(l).group_id=e)},null,8,["value"])]),_:1},8,["label"]),(0,i.Wm)(o,{label:(0,i.SU)(t)("contacts.tags.bulk.form.tags"),path:"tag_ids"},{default:(0,i.w5)(()=>[(0,i.Wm)(y,{value:(0,i.SU)(l).tag_ids,"onUpdate:value":n[1]||(n[1]=e=>(0,i.SU)(l).tag_ids=e),groupId:(0,i.SU)(l).group_id},null,8,["value","groupId"])]),_:1},8,["label"]),(0,i.Wm)(o,{label:(0,i.SU)(t)("contacts.tags.bulk.form.emails"),path:"data"},{default:(0,i.w5)(()=>[(0,i.Wm)(u,{value:(0,i.SU)(l).data,"onUpdate:value":n[2]||(n[2]=e=>(0,i.SU)(l).data=e),type:"textarea",rows:5,placeholder:(0,i.SU)(t)("contacts.tags.bulk.form.emailsPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,i.Wm)(o,{label:(0,i.SU)(t)("contacts.tags.bulk.form.action"),path:"mark_include"},{default:(0,i.w5)(()=>[(0,i.Wm)(s,{value:(0,i.SU)(l).mark_include,"onUpdate:value":n[3]||(n[3]=e=>(0,i.SU)(l).mark_include=e),options:(0,i.SU)(a)},null,8,["value","options"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title"])}}});var W=l(65965);let x={class:"w-200px"};function C(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,i.lA)(e)}let P=(0,i.aZ)({__name:"index",setup(e){let t=(0,c.tLD)(),{t:l}=(0,k.QT)(),{tableProps:S,pageProps:h,tableParams:U,fetchTable:w}=(0,g.N)({params:{keyword:"",group_id:t.value.state.group_id||0,page:1,page_size:10},useParams:e=>({...e,group_id:e.group_id||void 0}),fetchFn:f.kV}),b=(0,i.iH)([{key:"name",title:l("contacts.tags.columns.name"),minWidth:120,ellipsis:{tooltip:!0},render:e=>(0,i.Wm)(s.ZP,{type:"primary",text:!0,onClick:()=>{P(e)}},{default:()=>[e.name]})},{key:"group_name",title:l("contacts.tags.columns.groupName"),minWidth:120,ellipsis:{tooltip:!0}},{key:"create_time",title:l("contacts.tags.columns.createTime"),minWidth:140,render:e=>(0,p.mr)(e.create_time)},{key:"action",title:l("contacts.tags.columns.actions"),align:"right",width:180,render:e=>{let t,a,n;return(0,i.Wm)(d.Z,{inline:!0},{default:()=>[(0,i.Wm)(s.ZP,{type:"primary",text:!0,onClick:()=>{P(e)}},C(t=l("common.actions.view"))?t:{default:()=>[t]}),(0,i.Wm)(s.ZP,{type:"primary",text:!0,onClick:()=>{z(e)}},C(a=l("common.actions.edit"))?a:{default:()=>[a]}),(0,i.Wm)(s.ZP,{type:"error",text:!0,onClick:()=>{F(e)}},C(n=l("common.actions.delete"))?n:{default:()=>[n]})]})}}]),y=(0,W.tv)(),P=e=>{y.push({path:"/contacts/subscribers",state:{group_id:e.group_id,tag_id:e.id}})},[j,I]=(0,m.d)({component:_.Z,state:{refresh:w}}),T=()=>{I.setState({row:null,isEdit:!1,groupId:U.value.group_id}),I.open()},z=e=>{I.setState({row:e,isEdit:!0}),I.open()},F=e=>{(0,p.iG)({title:l("contacts.tags.delete.title"),content:l("contacts.tags.delete.confirm",{name:e.name}),onConfirm:async()=>{await (0,f.Pn)({id:e.id}),w()}})},[O,A]=(0,m.d)({component:Z,state:{refresh:w}}),R=()=>{A.open()};return(e,t)=>{let d=u.Z,c=o.Z,p=r.Z,m=n.Z,g=a.Z;return(0,i.wg)(),(0,i.j4)(g,null,{toolsLeft:(0,i.w5)(()=>[(0,i.Wm)((0,i.SU)(s.ZP),{type:"primary",onClick:T},{default:(0,i.w5)(()=>[(0,i.Uk)((0,i.zw)((0,i.SU)(l)("contacts.tags.addTag")),1)]),_:1}),(0,i.Wm)((0,i.SU)(s.ZP),{onClick:R},{default:(0,i.w5)(()=>[(0,i.Uk)((0,i.zw)((0,i.SU)(l)("contacts.tags.bulkTag")),1)]),_:1})]),toolsRight:(0,i.w5)(()=>[(0,i._)("div",x,[(0,i.Wm)(v.Z,{value:(0,i.SU)(U).group_id,"onUpdate:value":[t[0]||(t[0]=e=>(0,i.SU)(U).group_id=e),t[1]||(t[1]=()=>(0,i.SU)(w)(!0))],all:!0},null,8,["value"])]),(0,i.Wm)(d,{value:(0,i.SU)(U).keyword,"onUpdate:value":t[2]||(t[2]=e=>(0,i.SU)(U).keyword=e),width:240,placeholder:(0,i.SU)(l)("contacts.tags.searchPlaceholder"),onSearch:t[3]||(t[3]=()=>(0,i.SU)(w)(!0))},null,8,["value","placeholder"])]),table:(0,i.w5)(()=>[(0,i.Wm)(p,(0,i.dG)((0,i.SU)(S),{columns:(0,i.SU)(b)}),{empty:(0,i.w5)(()=>[(0,i.Wm)(c)]),_:1},16,["columns"])]),pageRight:(0,i.w5)(()=>[(0,i.Wm)(m,(0,i.dG)((0,i.SU)(h),{onRefresh:(0,i.SU)(w)}),null,16,["onRefresh"])]),modal:(0,i.w5)(()=>[(0,i.Wm)((0,i.SU)(j)),(0,i.Wm)((0,i.SU)(O))]),_:1})}}})}}]);