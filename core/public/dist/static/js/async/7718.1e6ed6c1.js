"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["7718"],{51169:function(e,t,a){a.d(t,{d:()=>u});var l=a(58786),n=a(49247);let o=Symbol("MODAL_INJECT"),u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{state:t={},component:a,onCancel:u,onConfirm:r}=e,i=(0,l.qj)({});return a?[(0,l.aZ)({setup(n,u){let{attrs:r,slots:d}=u;return(0,l.JJ)(o,{state:t,options:e,extendApi:e=>{Object.setPrototypeOf(i,e)},setState:e=>{Object.assign(t,e)}}),()=>(0,l.h)(a,{...n,...r},d)}}),i]:[(0,l.aZ)({setup(t,a){let{attrs:d,slots:s}=a,c=(0,l.f3)(o),p=(0,l.iH)(!1);return i.open=()=>{var t;p.value=!0,null==(t=e.onChangeState)||t.call(e,p.value)},i.close=()=>{p.value=!1},i.setState=t=>{var a;null==c||c.setState(t),null==(a=e.onChangeState)||a.call(e,p.value)},i.getState=()=>(null==c?void 0:c.state)??{},null==c||c.extendApi(i),()=>(0,l.Wm)(n.Z,(0,l.dG)({show:p.value},t,d,{onCancel:u,onConfirm:r,"onUpdate:show":e=>{p.value=e??!1}}),s)}}),i]}},46244:function(e,t,a){a.d(t,{Z:()=>o});var l=a(98048),n=a(58786);let o=(0,n.aZ)({__name:"index",props:{model:{},rules:{},labelWidth:{},labelPlacement:{default:"top"}},setup(e,t){let{expose:a}=t,o=(0,n.iH)(null);return a({validate:()=>{var e;return null==(e=o.value)?void 0:e.validate()},restoreValidation:()=>{var e;return null==(e=o.value)?void 0:e.restoreValidation()}}),(e,t)=>{let a=l.Z;return(0,n.wg)(),(0,n.j4)(a,(0,n.dG)(e.$attrs,{ref_key:"formRef",ref:o,model:e.model,rules:e.rules,"label-width":e.labelWidth,"label-placement":e.labelPlacement}),{default:(0,n.w5)(()=>[(0,n.WI)(e.$slots,"default")]),_:3},16,["model","rules","label-width","label-placement"])}}})},54181:function(e,t,a){a.r(t),a.d(t,{default:()=>P});var l=a(39244),n=a(25170),o=a(60424),u=a(66760),r=a(86559),i=a(58786),d=a(15496),s=a(93953),c=a(94821),p=a(68271),m=a(51169),g=a(80947),v=a(43458),f=a(69311),_=a(12112),S=a(46244),U=a(8490),h=a(73084),w=a(6455);let b={class:"flex-1 mr-12px"},k=(0,i.aZ)({__name:"TagSelect",props:(0,i.Vf)({groupId:{type:Number,default:0}},{value:{default:()=>[]},valueModifiers:{}}),emits:["update:value"],setup(e){let t=(0,i.tT)(e,"value"),a=(0,i.iH)(!1),l=(0,i.iH)([]),n=(0,i.Fl)(()=>l.value.filter(t=>t.group_id===e.groupId).map(e=>({label:e.name,value:e.id}))),o=async()=>{try{a.value=!0;let e=await (0,v.CZ)({});(0,p.Kn)(e)&&(l.value=e.list)}finally{a.value=!1}};o(),(0,i.YP)(()=>e.groupId,e=>{t.value=l.value.filter(t=>t.group_id===e).map(e=>e.id)});let[u,r]=(0,m.d)({component:_.Z,state:{refresh:o}}),s=()=>{r.setState({row:null,isEdit:!1,groupId:e.groupId}),r.open()};return(e,l)=>{let o=U.Z,r=d.ZP;return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",b,[(0,i.Wm)(o,{value:t.value,"onUpdate:value":l[0]||(l[0]=e=>t.value=e),loading:(0,i.SU)(a),tag:!0,multiple:!0,filterable:!0,options:(0,i.SU)(n)},null,8,["value","loading","options"])]),(0,i.Wm)(r,{type:"primary",text:"",onClick:s},{default:(0,i.w5)(()=>[(0,i.Uk)((0,i.zw)(e.$t("common.actions.create")),1)]),_:1}),(0,i.Wm)((0,i.SU)(u))],64)}}});var W=a(52495);let Z=(0,i.aZ)({__name:"TagBulk",setup(e){let{t}=(0,W.QT)(),a=(0,i.qj)({group_id:null,tag_ids:[],data:"",mark_include:1}),l=(0,i.Fl)(()=>[{label:t("contacts.tags.bulk.actions.tagThese"),value:1},{label:t("contacts.tags.bulk.actions.tagExcept"),value:0}]),n=()=>{a.group_id=null,a.tag_ids=[],a.data="",a.mark_include=1},[o]=(0,m.d)({onChangeState:()=>{n()},onConfirm:async()=>{await (0,v.Rc)({group_id:a.group_id||0,tag_ids:a.tag_ids,data:a.data,mark_include:a.mark_include})}});return(e,n)=>{let u=w.ZP,r=h.Z,d=U.Z,s=S.Z;return(0,i.wg)(),(0,i.j4)((0,i.SU)(o),{title:(0,i.SU)(t)("contacts.tags.bulk.title"),width:"560"},{default:(0,i.w5)(()=>[(0,i.Wm)(s,{ref:"formRef",class:"pt-16px",model:(0,i.SU)(a)},{default:(0,i.w5)(()=>[(0,i.Wm)(u,{label:(0,i.SU)(t)("contacts.tags.bulk.form.group"),path:"group_id"},{default:(0,i.w5)(()=>[(0,i.Wm)(f.Z,{value:(0,i.SU)(a).group_id,"onUpdate:value":n[0]||(n[0]=e=>(0,i.SU)(a).group_id=e)},null,8,["value"])]),_:1},8,["label"]),(0,i.Wm)(u,{label:(0,i.SU)(t)("contacts.tags.bulk.form.tags"),path:"tag_ids"},{default:(0,i.w5)(()=>[(0,i.Wm)(k,{value:(0,i.SU)(a).tag_ids,"onUpdate:value":n[1]||(n[1]=e=>(0,i.SU)(a).tag_ids=e),groupId:(0,i.SU)(a).group_id},null,8,["value","groupId"])]),_:1},8,["label"]),(0,i.Wm)(u,{label:(0,i.SU)(t)("contacts.tags.bulk.form.emails"),path:"data"},{default:(0,i.w5)(()=>[(0,i.Wm)(r,{value:(0,i.SU)(a).data,"onUpdate:value":n[2]||(n[2]=e=>(0,i.SU)(a).data=e),type:"textarea",rows:5,placeholder:(0,i.SU)(t)("contacts.tags.bulk.form.emailsPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,i.Wm)(u,{label:(0,i.SU)(t)("contacts.tags.bulk.form.action"),path:"mark_include"},{default:(0,i.w5)(()=>[(0,i.Wm)(d,{value:(0,i.SU)(a).mark_include,"onUpdate:value":n[3]||(n[3]=e=>(0,i.SU)(a).mark_include=e),options:(0,i.SU)(l)},null,8,["value","options"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title"])}}});var y=a(65965);let C={class:"w-200px"};function x(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,i.lA)(e)}let P=(0,i.aZ)({__name:"index",setup(e){let t=(0,c.tLD)(),{t:a}=(0,W.QT)(),{tableProps:S,pageProps:U,tableParams:h,fetchTable:w}=(0,g.N)({params:{keyword:"",group_id:t.value.state.group_id||0,page:1,page_size:10},useParams:e=>({...e,group_id:e.group_id||void 0}),fetchFn:v.kV}),b=(0,i.iH)([{key:"name",title:a("contacts.tags.columns.name"),minWidth:120,ellipsis:{tooltip:!0},render:e=>(0,i.Wm)(d.ZP,{type:"primary",text:!0,onClick:()=>{P(e)}},{default:()=>[e.name]})},{key:"group_name",title:a("contacts.tags.columns.groupName"),minWidth:120,ellipsis:{tooltip:!0}},{key:"create_time",title:a("contacts.tags.columns.createTime"),minWidth:140,render:e=>(0,p.mr)(e.create_time)},{key:"action",title:a("contacts.tags.columns.actions"),align:"right",width:180,render:e=>{let t,l,n;return(0,i.Wm)(s.Z,{inline:!0},{default:()=>[(0,i.Wm)(d.ZP,{type:"primary",text:!0,onClick:()=>{P(e)}},x(t=a("common.actions.view"))?t:{default:()=>[t]}),(0,i.Wm)(d.ZP,{type:"primary",text:!0,onClick:()=>{R(e)}},x(l=a("common.actions.edit"))?l:{default:()=>[l]}),(0,i.Wm)(d.ZP,{type:"error",text:!0,onClick:()=>{H(e)}},x(n=a("common.actions.delete"))?n:{default:()=>[n]})]})}}]),k=(0,y.tv)(),P=e=>{k.push({path:"/contacts/subscribers",state:{group_id:e.group_id,tag_id:e.id}})},[j,I]=(0,m.d)({component:_.Z,state:{refresh:w}}),T=()=>{I.setState({row:null,isEdit:!1,groupId:h.value.group_id}),I.open()},R=e=>{I.setState({row:e,isEdit:!0}),I.open()},H=e=>{(0,p.iG)({title:a("contacts.tags.delete.title"),content:a("contacts.tags.delete.confirm",{name:e.name}),onConfirm:async()=>{await (0,v.Pn)({id:e.id}),w()}})},[O,E]=(0,m.d)({component:Z,state:{refresh:w}}),G=()=>{E.open()};return(e,t)=>{let s=r.Z,c=u.Z,p=o.Z,m=n.Z,g=l.Z;return(0,i.wg)(),(0,i.j4)(g,null,{toolsLeft:(0,i.w5)(()=>[(0,i.Wm)((0,i.SU)(d.ZP),{type:"primary",onClick:T},{default:(0,i.w5)(()=>[(0,i.Uk)((0,i.zw)((0,i.SU)(a)("contacts.tags.addTag")),1)]),_:1}),(0,i.Wm)((0,i.SU)(d.ZP),{onClick:G},{default:(0,i.w5)(()=>[(0,i.Uk)((0,i.zw)((0,i.SU)(a)("contacts.tags.bulkTag")),1)]),_:1})]),toolsRight:(0,i.w5)(()=>[(0,i._)("div",C,[(0,i.Wm)(f.Z,{value:(0,i.SU)(h).group_id,"onUpdate:value":[t[0]||(t[0]=e=>(0,i.SU)(h).group_id=e),t[1]||(t[1]=()=>(0,i.SU)(w)(!0))],all:!0},null,8,["value"])]),(0,i.Wm)(s,{value:(0,i.SU)(h).keyword,"onUpdate:value":t[2]||(t[2]=e=>(0,i.SU)(h).keyword=e),width:240,placeholder:(0,i.SU)(a)("contacts.tags.searchPlaceholder"),onSearch:t[3]||(t[3]=()=>(0,i.SU)(w)(!0))},null,8,["value","placeholder"])]),table:(0,i.w5)(()=>[(0,i.Wm)(p,(0,i.dG)((0,i.SU)(S),{columns:(0,i.SU)(b)}),{empty:(0,i.w5)(()=>[(0,i.Wm)(c)]),_:1},16,["columns"])]),pageRight:(0,i.w5)(()=>[(0,i.Wm)(m,(0,i.dG)((0,i.SU)(U),{onRefresh:(0,i.SU)(w)}),null,16,["onRefresh"])]),modal:(0,i.w5)(()=>[(0,i.Wm)((0,i.SU)(j)),(0,i.Wm)((0,i.SU)(O))]),_:1})}}})}}]);