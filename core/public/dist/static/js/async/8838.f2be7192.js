"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["8838"],{93953:function(e,t,a){a.d(t,{Z:()=>g});var l=a(65083),n=a(58786),o=a(56946),s=a(54470),i=a(51048),r=a(71309),u=a(60951),p=a(6445),c=a(73238);let d={name:"Flex",self:function(){return c.Z}},m=Object.assign(Object.assign({},o.Z.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,reverse:Boolean,size:{type:[String,Number,Array],default:"medium"},wrap:{type:Boolean,default:!0}}),g=(0,n.aZ)({name:"Flex",props:m,setup(e){let{mergedClsPrefixRef:t,mergedRtlRef:a}=(0,s.ZP)(e),u=(0,o.Z)("Flex","-flex",void 0,d,e,t);return{rtlEnabled:(0,i.V)("Flex",a,t),mergedClsPrefix:t,margin:(0,n.Fl)(()=>{let{size:t}=e;if(Array.isArray(t))return{horizontal:t[0],vertical:t[1]};if("number"==typeof t)return{horizontal:t,vertical:t};let{self:{[(0,r.Tl)("gap",t)]:a}}=u.value,{row:n,col:o}=(0,l.yU)(a);return{horizontal:(0,l.fQ)(o),vertical:(0,l.fQ)(n)}})}},render(){let{vertical:e,reverse:t,align:a,inline:l,justify:o,margin:s,wrap:i,mergedClsPrefix:r,rtlEnabled:c}=this,d=(0,u.x)((0,p.z)(this),!1);return d.length?(0,n.h)("div",{role:"none",class:[`${r}-flex`,c&&`${r}-flex--rtl`],style:{display:l?"inline-flex":"flex",flexDirection:e&&!t?"column":e&&t?"column-reverse":!e&&t?"row-reverse":"row",justifyContent:o,flexWrap:!i||e?"nowrap":"wrap",alignItems:a,gap:`${s.vertical}px ${s.horizontal}px`}},d):null}})},84075:function(e,t,a){a.d(t,{WH:()=>s,Z2:()=>c,gV:()=>g,hI:()=>o,iE:()=>p,mD:()=>u,sS:()=>r,uz:()=>m,yG:()=>d,yL:()=>i});var l=a(34541);let{t:n}=a(76882).ag.global,o=e=>l.e.get("/contact/group/list",{params:e}),s=()=>l.e.get("/contact/group/all"),i=e=>l.e.get("/contact/group/info",{params:e}),r=e=>l.e.post("/contact/group/create",e,{fetchOptions:{loading:n("contacts.group.loading.createGroup"),successMessage:!0}}),u=e=>l.e.post("/contact/group/update",e,{fetchOptions:{loading:n("contacts.group.loading.updateGroup"),successMessage:!0}}),p=e=>l.e.post("/contact/group/delete",e,{fetchOptions:{loading:n("contacts.group.loading.deleteGroup"),successMessage:!0}}),c=e=>l.e.post("/contact/group/tag_contact_count",e),d=e=>l.e.post("/contact/group/export",e,{responseType:"blob",fetchOptions:{loading:n("contacts.group.loading.exportGroup"),successMessage:!0}}),m=e=>l.e.post("/contact/group/update",e,{fetchOptions:{loading:n("contacts.group.loading.saveSettings"),successMessage:!0}}),g=e=>l.e.post("/contact/group/update_unsubscribe",e,{fetchOptions:{loading:n("contacts.group.loading.saveSettings"),successMessage:!0}})},80947:function(e,t,a){a.d(t,{N:()=>s});var l=a(22895),n=a(68271),o=a(58786);let s=e=>{let{params:t,fetchFn:a,useParams:s,loading:i=!0,immediate:r=!0,rowKey:u=e=>e.id}=e,p=(0,o.iH)(i),c=(0,o.iH)([]),d=(0,o.iH)(0),m=(0,o.iH)(t),g=(0,o.iH)([]),f=()=>s?s(m.value):m.value,v=(0,l.DI)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&(m.value.page=1),p.value=!0;try{let e=f(),t=await a(e);(0,n.Kn)(t)&&(c.value=(0,n.kJ)(t.list)?t.list:[],d.value=(0,n.hj)(t.total)?t.total:0)}finally{g.value=[],p.value=!1}},300),h=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return v(e)},w=e=>{m.value.page=e},y=e=>{m.value.page_size=e};return(0,o.bv)(()=>{r&&h()}),{tableData:c,tableTotal:d,tableKeys:g,tableParams:m,fetchTable:h,resetTable:()=>h(!0),tableProps:(0,o.Fl)(()=>({rowKey:u,data:c.value,loading:p.value,checkedRowKeys:g.value,onUpdateCheckedRowKeys:e=>{g.value=e}})),batchProps:(0,o.Fl)(()=>({rowKey:u,data:c.value,checkedRowKeys:g.value,onUpdateCheckedRowKeys:e=>{g.value=e}})),pageProps:(0,o.Fl)(()=>({page:m.value.page,pageSize:m.value.page_size,itemCount:d.value,onUpdatePage:w,onUpdatePageSize:y}))}}},86559:function(e,t,a){a.d(t,{Z:()=>o});var l=a(73084),n=a(58786);let o=(0,n.aZ)({__name:"index",props:(0,n.Vf)({width:{default:240},prefix:{type:Boolean,default:!1}},{value:{default:""},valueModifiers:{}}),emits:(0,n.Vf)(["search"],["update:value"]),setup(e,t){let{expose:a,emit:o}=t,s=(0,n.iH)(null),i=(0,n.tT)(e,"value"),r=()=>{o("search",i.value)};return a({focus:()=>{var e;null==(e=s.value)||e.focus()}}),(e,t)=>{let a=l.Z;return(0,n.wg)(),(0,n.j4)(a,(0,n.dG)({ref_key:"inputRef",ref:s,value:i.value,"onUpdate:value":t[0]||(t[0]=e=>i.value=e)},e.$attrs,{class:"bt-search",style:{width:`${e.width}px`},onKeyup:(0,n.D2)(r,["enter"])}),(0,n.Nv)({_:2},[e.prefix?{name:"prefix",fn:(0,n.w5)(()=>[(0,n._)("div",{class:"flex items-center cursor-pointer",onClick:r},t[1]||(t[1]=[(0,n._)("i",{class:"i-mdi-search text-16px"},null,-1)]))]),key:"0"}:void 0,e.prefix?void 0:{name:"suffix",fn:(0,n.w5)(()=>[(0,n._)("div",{class:"flex items-center cursor-pointer",onClick:r},t[2]||(t[2]=[(0,n._)("i",{class:"i-mdi-search text-16px"},null,-1)]))]),key:"1"}]),1040,["value","style"])}}})},4340:function(e,t,a){a.d(t,{Z:()=>r});var l=a(15496),n=a(23685),o=a(58786);let s={class:"flex gap-10px"},i={class:"flex-center w-40px"},r=(0,o.aZ)({__name:"index",props:{data:{type:Array,default:()=>[]},rowKey:{type:Function,required:!0},options:{type:Array,default:()=>[]},checkedRowKeys:{type:Array,default:()=>[]}},emits:["updateCheckedRowKeys","select"],setup(e,t){let{emit:a}=t,r=(0,o.Fl)({get:()=>e.checkedRowKeys.length>0&&e.checkedRowKeys.length===e.data.length,set(t){a("updateCheckedRowKeys",t?e.data.map(t=>e.rowKey(t)):[])}}),u=(0,o.Fl)(()=>0===e.data.length),p=(0,o.Fl)(()=>e.checkedRowKeys.length>0&&e.checkedRowKeys.length<e.data.length),c=(0,o.Fl)(()=>0===e.checkedRowKeys.length),d=t=>{a("select",t,e.checkedRowKeys)};return(t,a)=>{let m=n.Z,g=l.ZP;return(0,o.wg)(),(0,o.iD)("div",s,[(0,o._)("div",i,[(0,o.Wm)(m,{checked:(0,o.SU)(r),"onUpdate:checked":a[0]||(a[0]=e=>(0,o.dq)(r)?r.value=e:null),disabled:(0,o.SU)(u),indeterminate:(0,o.SU)(p)},null,8,["checked","disabled","indeterminate"])]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.options,e=>((0,o.wg)(),(0,o.j4)(g,{key:e.value,disabled:(0,o.SU)(c)||e.disabled,onClick:t=>d(e.value)},{default:(0,o.w5)(()=>[(0,o.Uk)((0,o.zw)(e.label),1)]),_:2},1032,["disabled","onClick"]))),128))])}}})},66760:function(e,t,a){a.d(t,{Z:()=>i});var l=a(81021),n=a(15496),o=a(58786);let s={class:"leading-22px text-13px text-desc text-center"},i=(0,o.aZ)({__name:"index",setup(e){let t=()=>{window.open("https://github.com/aaPanel/BillionMail/issues")},a=()=>{window.open("https://github.com/aaPanel/BillionMail")};return(e,i)=>{let r=n.ZP,u=(0,o.up)("i18n-t"),p=l.Z;return(0,o.wg)(),(0,o.j4)(p,null,{default:(0,o.w5)(()=>[(0,o._)("div",s,[(0,o.Wm)(u,{tag:"span",scope:"global",keypath:"components.tableHelp.text1"},{issues:(0,o.w5)(()=>[(0,o.Wm)(r,{class:"text-13px",type:"primary",text:"",onClick:t},{default:(0,o.w5)(()=>i[0]||(i[0]=[(0,o._)("span",null,"Issues",-1),(0,o._)("i",{class:"i-mdi:arrow-right ml-1px"},null,-1)])),_:1,__:[0]})]),star:(0,o.w5)(()=>[(0,o.Wm)(r,{class:"text-13px",type:"primary",text:"",onClick:a},{default:(0,o.w5)(()=>i[1]||(i[1]=[(0,o.Uk)(" Star "),(0,o._)("i",{class:"i-mdi:arrow-right ml-1px"},null,-1)])),_:1,__:[1]})]),_:1}),i[2]||(i[2]=(0,o._)("br",null,null,-1)),(0,o._)("span",null,(0,o.zw)(e.$t("components.tableHelp.text2")),1)])]),_:1})}}})},39244:function(e,t,a){a.d(t,{Z:()=>o});var l=a(93953),n=a(58786);let o=(0,n.aZ)({__name:"index",setup(e){let t=!!(0,n.Rr)().toolsLeft,a=!!(0,n.Rr)().toolsRight,o=!!(0,n.Rr)().pageLeft||!!(0,n.Rr)().pageRight;return(e,s)=>{let i=l.Z;return(0,n.wg)(),(0,n.iD)("div",null,[t||a?((0,n.wg)(),(0,n.j4)(i,{key:0,class:"items-center mb-12px",justify:"space-between"},{default:(0,n.w5)(()=>[(0,n.Wm)(i,{class:"items-center",size:12},{default:(0,n.w5)(()=>[(0,n.WI)(e.$slots,"toolsLeft")]),_:3}),(0,n.Wm)(i,{class:"items-center",size:12},{default:(0,n.w5)(()=>[(0,n.WI)(e.$slots,"toolsRight")]),_:3})]),_:3})):(0,n.kq)("",!0),(0,n.WI)(e.$slots,"table"),(0,n.SU)(o)?((0,n.wg)(),(0,n.j4)(i,{key:1,class:"items-center mt-12px",justify:"space-between"},{default:(0,n.w5)(()=>[(0,n._)("div",null,[(0,n.WI)(e.$slots,"pageLeft")]),(0,n.Wm)(i,null,{default:(0,n.w5)(()=>[(0,n.WI)(e.$slots,"pageRight")]),_:3})]),_:3})):(0,n.kq)("",!0),(0,n.WI)(e.$slots,"modal")])}}})},25170:function(e,t,a){a.d(t,{Z:()=>i});var l=a(75459),n=a(58786),o=a(68271);let s={class:"ml-8px text-14px"},i=(0,n.aZ)({__name:"index",props:(0,n.Vf)({storeKey:{default:""},pageSizes:{default:()=>[10,20,50,100]},showTotal:{type:Boolean,default:!0},showSizePicker:{type:Boolean,default:!0},showQuickJumper:{type:Boolean,default:!0},onUpdatePage:{}},{page:{},pageModifiers:{},pageSize:{},pageSizeModifiers:{}}),emits:(0,n.Vf)(["refresh"],["update:page","update:pageSize"]),setup(e,t){let{emit:a}=t,i=(0,n.Fl)(()=>{let{storeKey:t}=e;return t?`${t}-page`:""}),r=(0,n.tT)(e,"page"),u=(0,n.tT)(e,"pageSize"),p=t=>{var l;null==(l=e.onUpdatePage)||l.call(e,t),a("refresh")},c=t=>{var l;r.value=1,null==(l=e.onUpdatePage)||l.call(e,1),d(t),a("refresh")},d=e=>{i.value&&(0,o.qQ)(i.value,String(e))};if(i.value){let e=(0,o.$o)(i.value);e&&(u.value=(0,o.Dx)(e))}return(e,t)=>{let a=l.Z;return(0,n.wg)(),(0,n.j4)(a,(0,n.dG)(e.$attrs,{page:r.value,"onUpdate:page":[t[0]||(t[0]=e=>r.value=e),p],"page-size":u.value,"onUpdate:pageSize":[t[1]||(t[1]=e=>u.value=e),c],"show-size-picker":e.showSizePicker,"show-quick-jumper":e.showQuickJumper,"page-sizes":e.pageSizes,"display-order":["pages","size-picker","quick-jumper"]}),(0,n.Nv)({_:2},[e.showTotal?{name:"suffix",fn:(0,n.w5)(e=>{let{itemCount:t}=e;return[(0,n._)("span",s," Total "+(0,n.zw)(t),1)]}),key:"0"}:void 0]),1040,["page","page-size","show-size-picker","show-quick-jumper","page-sizes"])}}})},52084:function(e,t,a){a.r(t),a.d(t,{default:()=>$});var l=a(39244),n=a(25170),o=a(4340),s=a(60424),i=a(66760),r=a(86559),u=a(58786),p=a(15496),c=a(53903),d=a(93953),m=a(8490),g=a(68271),f=a(51169),v=a(80947),h=a(84075),w=a(46244),y=a(3179),_=a(6455),x=a(73084),b=a(98003),k=a(52495);let S={class:"pt-12px"},U={class:"flex-1"},Z={class:"mt-8px text-desc"},W={class:"mr-4px"},z=`email,attributes
example1@example.com,"{""age"": ""13"", ""Gender"": ""XXX""}"
example2@example.com,"{""age"": ""45"", ""city"": ""XXX""}"
`,R=(0,u.aZ)({__name:"GroupAdd",setup(e){let{t}=(0,k.QT)(),a=(0,u.AE)("formRef"),l=(0,u.qj)({create_type:2,name:"",description:"",double_optin:0,file_data:"",file_type:""}),n={name:{required:!0,message:t("contacts.group.form.nameRequired"),trigger:"blur"}},o=[{label:"Single Opt-in",value:0},{label:"Double Opt-in",value:1}],s=e=>{let t=new FileReader;t.onload=t=>{var a;l.file_type=e.name.substring(e.name.lastIndexOf(".")+1),l.file_data=null==(a=t.target)?void 0:a.result},e.file&&t.readAsText(e.file)},i=async()=>{await (0,b.Sv)({file_path:"./template/example_recipients.csv"})},[r,c]=(0,f.d)({onChangeState:e=>{e&&(l.name="")},onConfirm:async()=>{var e;await (null==(e=a.value)?void 0:e.validate()),await (0,h.sS)((0,u.IU)(l));let t=c.getState();null==t||t.refresh()}});return(e,c)=>{let d=x.Z,g=_.ZP,f=m.Z,v=y.Z,h=p.ZP,b=w.Z;return(0,u.wg)(),(0,u.j4)((0,u.SU)(r),{title:(0,u.SU)(t)("contacts.group.add.title"),width:"540"},{default:(0,u.w5)(()=>[(0,u._)("div",S,[(0,u.Wm)(b,{ref_key:"formRef",ref:a,model:(0,u.SU)(l),rules:n},{default:(0,u.w5)(()=>[(0,u.Wm)(g,{label:(0,u.SU)(t)("contacts.group.form.name"),path:"name"},{default:(0,u.w5)(()=>[(0,u.Wm)(d,{value:(0,u.SU)(l).name,"onUpdate:value":c[0]||(c[0]=e=>(0,u.SU)(l).name=e)},null,8,["value"])]),_:1},8,["label"]),(0,u.Wm)(g,{label:"List Type"},{default:(0,u.w5)(()=>[(0,u.Wm)(f,{value:(0,u.SU)(l).double_optin,"onUpdate:value":c[1]||(c[1]=e=>(0,u.SU)(l).double_optin=e),options:o},null,8,["value"])]),_:1}),(0,u.Wm)(g,{label:(0,u.SU)(t)("contacts.group.form.file"),path:"file_data"},{default:(0,u.w5)(()=>[(0,u._)("div",U,[(0,u.Wm)(v,{"is-upload":!1,"max-size":10,accept:["csv"],onChange:s}),(0,u._)("div",Z,[(0,u._)("span",W,(0,u.zw)((0,u.SU)(t)("contacts.group.fileUpload.hint")),1),(0,u.Wm)(h,{text:"",type:"primary",onClick:i},{default:(0,u.w5)(()=>[(0,u.Uk)((0,u.zw)(e.$t("common.actions.download")),1)]),_:1})])])]),_:1},8,["label"]),(0,u.Wm)(g,{label:"Example raw CSV"},{default:(0,u.w5)(()=>[(0,u._)("pre",{class:"csv-example"},(0,u.zw)(z))]),_:1})]),_:1},8,["model"])])]),_:1},8,["title"])}}}),C=(0,a(41748).default)(R,[["__scopeId","data-v-d82248ee"]]),j={class:"pt-12px"},P=(0,u.aZ)({__name:"GroupRename",setup(e){let{t}=(0,k.QT)(),a=(0,u.AE)("formRef"),l=(0,u.qj)({group_id:0,name:""}),n={name:{required:!0,message:t("contacts.group.form.nameRequired"),trigger:"blur"}},[o,s]=(0,f.d)({onChangeState:e=>{if(e){let{row:e}=s.getState();e&&(l.group_id=e.id,l.name=e.name)}else l.group_id=0,l.name=""},onConfirm:async()=>{var e;await (null==(e=a.value)?void 0:e.validate()),await (0,h.mD)((0,u.IU)(l));let t=s.getState();null==t||t.refresh()}});return(e,s)=>{let i=x.Z,r=_.ZP,p=w.Z;return(0,u.wg)(),(0,u.j4)((0,u.SU)(o),{title:(0,u.SU)(t)("contacts.group.rename.title"),width:"400"},{default:(0,u.w5)(()=>[(0,u._)("div",j,[(0,u.Wm)(p,{ref_key:"formRef",ref:a,model:(0,u.SU)(l),rules:n},{default:(0,u.w5)(()=>[(0,u.Wm)(r,{label:(0,u.SU)(t)("contacts.group.form.name"),path:"name"},{default:(0,u.w5)(()=>[(0,u.Wm)(i,{value:(0,u.SU)(l).name,"onUpdate:value":s[0]||(s[0]=e=>(0,u.SU)(l).name=e)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["title"])}}});var K=a(65965);function T(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,u.lA)(e)}let $=(0,u.aZ)({__name:"index",setup(e){let{t}=(0,k.QT)(),a=(0,K.tv)(),{tableProps:w,pageProps:y,batchProps:_,tableParams:x,fetchTable:b}=(0,v.N)({params:{page:1,page_size:10,keyword:""},fetchFn:h.hI}),S=(0,u.iH)([{type:"selection"},{key:"name",title:t("contacts.group.columns.name"),minWidth:120,render:e=>(0,u.Wm)(p.ZP,{text:!0,type:"primary",onClick:()=>{a.push({path:"/contacts/subscribers",state:{group_id:e.id}})}},{default:()=>[e.name]})},{key:"total_count",title:t("contacts.group.columns.subscribers"),minWidth:100,render:e=>(0,u.Wm)(c.ZP,{size:"small",type:"primary",bordered:!1},{default:()=>[e.total_count-e.unsubscribe_count]})},{key:"double_optin",title:t("contacts.group.columns.type"),minWidth:100,render:e=>1===e.double_optin?t("contacts.group.type.doubleOptin"):t("contacts.group.type.singleOptin")},{key:"create_time",title:t("contacts.group.columns.createdAt"),minWidth:140,render:e=>(0,g.mr)(e.create_time)},{title:t("common.columns.actions"),key:"actions",align:"right",width:180,render:e=>{let a,l,n;return(0,u.Wm)(d.Z,{inline:!0},{default:()=>[(0,u.Wm)(p.ZP,{type:"primary",text:!0,onClick:()=>{F(e)}},T(a=t("common.actions.settings"))?a:{default:()=>[a]}),(0,u.Wm)(p.ZP,{type:"primary",text:!0,onClick:()=>{O(e)}},T(l=t("common.actions.edit"))?l:{default:()=>[l]}),(0,u.Wm)(p.ZP,{type:"error",text:!0,onClick:()=>{q(e)}},T(n=t("common.actions.delete"))?n:{default:()=>[n]})]})}}]),U=[{label:t("common.actions.export"),value:"export"}],Z=(e,t)=>{"export"===e&&z(t)},W=(0,u.iH)([{label:"CSV",value:"csv"},{label:"TXT",value:"txt"}]),z=e=>{let a=(0,u.iH)("csv");(0,g.iG)({title:t("contacts.group.export.title"),content:()=>(0,u.Wm)(u.HY,null,[(0,u.Wm)("div",{class:"mb-10px"},[t("contacts.group.export.confirm",{count:e.length})]),(0,u.Wm)("div",{class:"flex"},[(0,u.Wm)(m.Z,{value:a.value,options:W.value,"onUpdate:value":e=>{a.value=e}},null)])]),onConfirm:async()=>{await (0,h.yG)({format:a.value,include_unsubscribe:!0,group_ids:e,export_type:1})}})},[R,j]=(0,f.d)({component:C,state:{refresh:b}}),$=()=>{j.open()},F=e=>{a.push(`/contacts/settings/${e.id}`)},[G,I]=(0,f.d)({component:P,state:{refresh:b}}),O=e=>{I.setState({row:e}),I.open()},q=e=>{(0,g.iG)({title:t("contacts.group.delete.title"),content:t("contacts.group.delete.confirm",{name:e.name}),confirmText:t("common.actions.delete"),confirmType:"error",onConfirm:async()=>{await (0,h.iE)({group_ids:[e.id]}),b()}})};return(e,a)=>{let c=r.Z,d=i.Z,m=s.Z,g=o.Z,f=n.Z,v=l.Z;return(0,u.wg)(),(0,u.j4)(v,null,{toolsLeft:(0,u.w5)(()=>[(0,u.Wm)((0,u.SU)(p.ZP),{type:"primary",onClick:$},{default:(0,u.w5)(()=>a[2]||(a[2]=[(0,u.Uk)("Add group")])),_:1,__:[2]})]),toolsRight:(0,u.w5)(()=>[(0,u.Wm)(c,{value:(0,u.SU)(x).keyword,"onUpdate:value":a[0]||(a[0]=e=>(0,u.SU)(x).keyword=e),width:280,placeholder:(0,u.SU)(t)("contacts.group.search.namePlaceholder"),onSearch:a[1]||(a[1]=()=>(0,u.SU)(b)(!0))},null,8,["value","placeholder"])]),table:(0,u.w5)(()=>[(0,u.Wm)(m,(0,u.dG)((0,u.SU)(w),{columns:(0,u.SU)(S)}),{empty:(0,u.w5)(()=>[(0,u.Wm)(d)]),_:1},16,["columns"])]),pageLeft:(0,u.w5)(()=>[(0,u.Wm)(g,(0,u.dG)((0,u.SU)(_),{options:U,onSelect:Z}),null,16)]),pageRight:(0,u.w5)(()=>[(0,u.Wm)(f,(0,u.dG)((0,u.SU)(y),{onRefresh:(0,u.SU)(b)}),null,16,["onRefresh"])]),modal:(0,u.w5)(()=>[(0,u.Wm)((0,u.SU)(R)),(0,u.Wm)((0,u.SU)(G))]),_:1})}}})}}]);